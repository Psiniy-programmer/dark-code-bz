var b="named",ut="name",z="unmanaged",ct="optional",G="inject",M="multi_inject",lt="inversify:tagged",ft="inversify:tagged_props",Y="inversify:paramtypes",Rt="design:paramtypes",X="post_construct",$="pre_destroy";function Mt(){return[G,M,ut,z,b,ct]}var tt=Mt(),p={Request:"Request",Singleton:"Singleton",Transient:"Transient"},d={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},P={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},xt=0;function C(){return xt++}var Bt=function(){function e(t,n){this.id=C(),this.activated=!1,this.serviceIdentifier=t,this.scope=n,this.type=d.Invalid,this.constraint=function(r){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=t.scope===p.Singleton?this.activated:!1,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.onDeactivation=this.onDeactivation,t.cache=this.cache,t},e}(),Pt="Cannot apply @injectable decorator multiple times.",ht="Metadata key was used more than once in a parameter:",E="NULL argument",nt="Key Not Found",Ft="Ambiguous match found for serviceIdentifier:",jt="Could not unbind serviceIdentifier:",kt="No matching bindings found for serviceIdentifier:",dt="Missing required @injectable annotation in:",Vt="Missing required @inject or @multiInject annotation in:",Wt=function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifier to  overcome this limitation."},Lt="Circular dependency found:",Gt="Invalid binding type:",Ut="No snapshot available to restore.",Kt="Invalid return type in middleware. Middleware must return!",Ht="Value provided to function binding must be a function!",Yt=function(e){return"You are attempting to construct '"+e+`' in a synchronous way
 but it has asynchronous dependencies.`},$t="The toSelf function can only be applied when a constructor is used as service identifier",pt="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",Jt=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+(e[0]+" must be >= than the number of constructor arguments of its base class.")},zt="Invalid Container constructor argument. Container options must be an object.",qt='Invalid Container option. Default scope must be a string ("singleton" or "transient").',Qt="Invalid Container option. Auto bind injectable must be a boolean",Zt="Invalid Container option. Skip base check must be a boolean",Xt="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)",tn=function(e,t){return"@postConstruct error in class "+e+": "+t},nn=function(e,t){return"@preDestroy error in class "+e+": "+t},J=function(e,t){return"onDeactivation() error in class "+e+": "+t},en=function(e,t){return"It looks like there is a circular dependency in one of the '"+e+"' bindings. Please investigate bindings with "+("service identifier '"+t+"'.")},rn="Maximum call stack size exceeded",on=function(){function e(){}return e.prototype.getConstructorMetadata=function(t){var n=Reflect.getMetadata(Y,t),r=Reflect.getMetadata(lt,t);return{compilerGeneratedMetadata:n,userGeneratedMetadata:r||{}}},e.prototype.getPropertiesMetadata=function(t){var n=Reflect.getMetadata(ft,t)||[];return n},e}(),j={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function vt(e){return e instanceof RangeError||e.message===rn}var an=function(e,t){try{return e()}catch(n){throw vt(n)&&(n=t()),n}};function x(e){if(typeof e=="function"){var t=e;return t.name}else{if(typeof e=="symbol")return e.toString();var t=e;return t}}function et(e,t,n){var r="",o=n(e,t);return o.length!==0&&(r=`
Registered bindings:`,o.forEach(function(i){var s="Object";i.implementationType!==null&&(s=U(i.implementationType)),r=r+`
 `+s,i.constraint.metaData&&(r=r+" - "+i.constraint.metaData)})),r}function yt(e,t){return e.parentRequest===null?!1:e.parentRequest.serviceIdentifier===t?!0:yt(e.parentRequest,t)}function sn(e){function t(r,o){o===void 0&&(o=[]);var i=x(r.serviceIdentifier);return o.push(i),r.parentRequest!==null?t(r.parentRequest,o):o}var n=t(e);return n.reverse().join(" --> ")}function gt(e){e.childRequests.forEach(function(t){if(yt(t,t.serviceIdentifier)){var n=sn(t);throw new Error(Lt+" "+n)}else gt(t)})}function un(e,t){if(t.isTagged()||t.isNamed()){var n="",r=t.getNamedTag(),o=t.getCustomTags();return r!==null&&(n+=r.toString()+`
`),o!==null&&o.forEach(function(i){n+=i.toString()+`
`})," "+e+`
 `+e+" - "+n}else return" "+e}function U(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}function cn(e){return e.toString().slice(7,-1)}var _t=function(){function e(t){this.id=C(),this.container=t}return e.prototype.addPlan=function(t){this.plan=t},e.prototype.setCurrentRequest=function(t){this.currentRequest=t},e}(),I=function(){function e(t,n){this.key=t,this.value=n}return e.prototype.toString=function(){return this.key===b?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},e}(),ln=function(){function e(t,n){this.parentContext=t,this.rootRequest=n}return e}(),fn=function(){function e(t){this._cb=t}return e.prototype.unwrap=function(){return this._cb()},e}(),hn=function(){function e(t){this.str=t}return e.prototype.startsWith=function(t){return this.str.indexOf(t)===0},e.prototype.endsWith=function(t){var n="",r=t.split("").reverse().join("");return n=this.str.split("").reverse().join(""),this.startsWith.call({str:n},r)},e.prototype.contains=function(t){return this.str.indexOf(t)!==-1},e.prototype.equals=function(t){return this.str===t},e.prototype.value=function(){return this.str},e}(),K=function(){function e(t,n,r,o){this.id=C(),this.type=t,this.serviceIdentifier=r;var i=typeof n=="symbol"?cn(n):n;this.name=new hn(i||""),this.identifier=n,this.metadata=new Array;var s=null;typeof o=="string"?s=new I(b,o):o instanceof I&&(s=o),s!==null&&this.metadata.push(s)}return e.prototype.hasTag=function(t){for(var n=0,r=this.metadata;n<r.length;n++){var o=r[n];if(o.key===t)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(M)},e.prototype.matchesArray=function(t){return this.matchesTag(M)(t)},e.prototype.isNamed=function(){return this.hasTag(b)},e.prototype.isTagged=function(){return this.metadata.some(function(t){return tt.every(function(n){return t.key!==n})})},e.prototype.isOptional=function(){return this.matchesTag(ct)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(t){return t.key===b})[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(t){return tt.every(function(n){return t.key!==n})}):null},e.prototype.matchesNamedTag=function(t){return this.matchesTag(b)(t)},e.prototype.matchesTag=function(t){var n=this;return function(r){for(var o=0,i=n.metadata;o<i.length;o++){var s=i[o];if(s.key===t&&s.value===r)return!0}return!1}},e}(),k=globalThis&&globalThis.__spreadArray||function(e,t,n){if(n||arguments.length===2)for(var r=0,o=t.length,i;r<o;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))};function dn(e,t){var n=U(t);return bt(e,n,t,!1)}function bt(e,t,n,r){var o=e.getConstructorMetadata(n),i=o.compilerGeneratedMetadata;if(i===void 0){var s=dt+" "+t+".";throw new Error(s)}var u=o.userGeneratedMetadata,l=Object.keys(u),a=n.length===0&&l.length>0,c=l.length>n.length,f=a||c?l.length:n.length,h=vn(r,t,i,u,f),w=wt(e,n,t),T=k(k([],h,!0),w,!0);return T}function pn(e,t,n,r,o){var i=o[e.toString()]||[],s=mt(i),u=s.unmanaged!==!0,l=r[e],a=s.inject||s.multiInject;if(l=a||l,l instanceof fn&&(l=l.unwrap()),u){var c=l===Object,f=l===Function,h=l===void 0,w=c||f||h;if(!t&&w){var T=Vt+" argument "+e+" in class "+n+".";throw new Error(T)}var D=new K(P.ConstructorArgument,s.targetName,l);return D.metadata=i,D}return null}function vn(e,t,n,r,o){for(var i=[],s=0;s<o;s++){var u=s,l=pn(u,e,t,n,r);l!==null&&i.push(l)}return i}function yn(e,t,n,r){var o=e||t;if(o===void 0){var i=dt+" for property "+String(n)+" in class "+r+".";throw new Error(i)}return o}function wt(e,t,n){for(var r=e.getPropertiesMetadata(t),o=[],i=Object.getOwnPropertySymbols(r),s=Object.keys(r),u=s.concat(i),l=0,a=u;l<a.length;l++){var c=a[l],f=r[c],h=mt(f),w=h.targetName||c,T=yn(h.inject,h.multiInject,c,n),D=new K(P.ClassProperty,w,T);D.metadata=f,o.push(D)}var Z=Object.getPrototypeOf(t.prototype).constructor;if(Z!==Object){var Ot=wt(e,Z,n);o=k(k([],o,!0),Ot,!0)}return o}function At(e,t){var n=Object.getPrototypeOf(t.prototype).constructor;if(n!==Object){var r=U(n),o=bt(e,r,n,!0),i=o.map(function(l){return l.metadata.filter(function(a){return a.key===z})}),s=[].concat.apply([],i).length,u=o.length-s;return u>0?u:At(e,n)}else return 0}function mt(e){var t={};return e.forEach(function(n){t[n.key.toString()]=n.value}),{inject:t[G],multiInject:t[M],targetName:t[ut],unmanaged:t[z]}}var q=function(){function e(t,n,r,o,i){this.id=C(),this.serviceIdentifier=t,this.parentContext=n,this.parentRequest=r,this.target=i,this.childRequests=[],this.bindings=Array.isArray(o)?o:[o],this.requestScope=r===null?new Map:null}return e.prototype.addChildRequest=function(t,n,r){var o=new e(t,this.parentContext,this,n,r);return this.childRequests.push(o),o},e}();function V(e){return e._bindingDictionary}function gn(e,t,n,r,o,i){var s=e?M:G,u=new I(s,n),l=new K(t,r,n,u);if(o!==void 0){var a=new I(o,i);l.metadata.push(a)}return l}function rt(e,t,n,r,o){var i=B(n.container,o.serviceIdentifier),s=[];return i.length===j.NoBindingsAvailable&&n.container.options.autoBindInjectable&&typeof o.serviceIdentifier=="function"&&e.getConstructorMetadata(o.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(o.serviceIdentifier).toSelf(),i=B(n.container,o.serviceIdentifier)),t?s=i:s=i.filter(function(u){var l=new q(u.serviceIdentifier,n,r,u,o);return u.constraint(l)}),_n(o.serviceIdentifier,s,o,n.container),s}function _n(e,t,n,r){switch(t.length){case j.NoBindingsAvailable:if(n.isOptional())return t;var o=x(e),i=kt;throw i+=un(o,n),i+=et(r,o,B),new Error(i);case j.OnlyOneBindingAvailable:return t;case j.MultipleBindingsAvailable:default:if(n.isArray())return t;var o=x(e),i=Ft+" "+o;throw i+=et(r,o,B),new Error(i)}}function Tt(e,t,n,r,o,i){var s,u;if(o===null){s=rt(e,t,r,null,i),u=new q(n,r,null,s,i);var l=new ln(r,u);r.addPlan(l)}else s=rt(e,t,r,o,i),u=o.addChildRequest(i.serviceIdentifier,s,i);s.forEach(function(a){var c=null;if(i.isArray())c=u.addChildRequest(a.serviceIdentifier,a,i);else{if(a.cache)return;c=u}if(a.type===d.Instance&&a.implementationType!==null){var f=dn(e,a.implementationType);if(!r.container.options.skipBaseClassChecks){var h=At(e,a.implementationType);if(f.length<h){var w=Jt(U(a.implementationType));throw new Error(w)}}f.forEach(function(T){Tt(e,!1,T.serviceIdentifier,r,c,T)})}})}function B(e,t){var n=[],r=V(e);return r.hasKey(t)?n=r.get(t):e.parent!==null&&(n=B(e.parent,t)),n}function bn(e,t,n,r,o,i,s,u){u===void 0&&(u=!1);var l=new _t(t),a=gn(n,r,o,"",i,s);try{return Tt(e,u,o,l,null,a),l}catch(c){throw vt(c)&&gt(l.plan.rootRequest),c}}function wn(e,t,n,r){var o=new K(P.Variable,"",t,new I(n,r)),i=new _t(e),s=new q(t,i,null,[],o);return s}function y(e){var t=typeof e=="object"&&e!==null||typeof e=="function";return t&&typeof e.then=="function"}function St(e){return y(e)?!0:Array.isArray(e)&&e.some(y)}var An=globalThis&&globalThis.__awaiter||function(e,t,n,r){function o(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function u(c){try{a(r.next(c))}catch(f){s(f)}}function l(c){try{a(r.throw(c))}catch(f){s(f)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((r=r.apply(e,t||[])).next())})},mn=globalThis&&globalThis.__generator||function(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return n.label++,{value:a[1],done:!1};case 5:n.label++,o=a[1],a=[0];continue;case 7:a=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){n.label=a[1];break}if(a[0]===6&&n.label<i[1]){n.label=i[1],i=a;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(a);break}i[2]&&n.ops.pop(),n.trys.pop();continue}a=t.call(e,n)}catch(c){a=[6,c],o=0}finally{r=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Tn=function(e,t){return t.scope===p.Singleton&&t.activated?t.cache:t.scope===p.Request&&e.has(t.id)?e.get(t.id):null},Sn=function(e,t,n){t.scope===p.Singleton&&Nn(t,n),t.scope===p.Request&&In(e,t,n)},In=function(e,t,n){e.has(t.id)||e.set(t.id,n)},Nn=function(e,t){e.cache=t,e.activated=!0,y(t)&&Cn(e,t)},Cn=function(e,t){return An(void 0,void 0,void 0,function(){var n,r;return mn(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,t];case 1:return n=o.sent(),e.cache=n,[3,3];case 2:throw r=o.sent(),e.cache=null,e.activated=!1,r;case 3:return[2]}})})},R;(function(e){e.DynamicValue="toDynamicValue",e.Factory="toFactory",e.Provider="toProvider"})(R||(R={}));var Dn=function(e){var t=null;switch(e.type){case d.ConstantValue:case d.Function:t=e.cache;break;case d.Constructor:case d.Instance:t=e.implementationType;break;case d.DynamicValue:t=e.dynamicValue;break;case d.Provider:t=e.provider;break;case d.Factory:t=e.factory;break}if(t===null){var n=x(e.serviceIdentifier);throw new Error(Gt+" "+n)}},En=function(e){switch(e.type){case d.Factory:return{factory:e.factory,factoryType:R.Factory};case d.Provider:return{factory:e.provider,factoryType:R.Provider};case d.DynamicValue:return{factory:e.dynamicValue,factoryType:R.DynamicValue};default:throw new Error("Unexpected factory type "+e.type)}},N=globalThis&&globalThis.__assign||function(){return N=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},N.apply(this,arguments)},It=globalThis&&globalThis.__awaiter||function(e,t,n,r){function o(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function u(c){try{a(r.next(c))}catch(f){s(f)}}function l(c){try{a(r.throw(c))}catch(f){s(f)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((r=r.apply(e,t||[])).next())})},Nt=globalThis&&globalThis.__generator||function(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return n.label++,{value:a[1],done:!1};case 5:n.label++,o=a[1],a=[0];continue;case 7:a=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){n.label=a[1];break}if(a[0]===6&&n.label<i[1]){n.label=i[1],i=a;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(a);break}i[2]&&n.ops.pop(),n.trys.pop();continue}a=t.call(e,n)}catch(c){a=[6,c],o=0}finally{r=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},On=globalThis&&globalThis.__spreadArray||function(e,t,n){if(n||arguments.length===2)for(var r=0,o=t.length,i;r<o;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))};function Rn(e,t){return e.reduce(function(n,r){var o=t(r),i=r.target.type;return i===P.ConstructorArgument?n.constructorInjections.push(o):(n.propertyRequests.push(r),n.propertyInjections.push(o)),n.isAsync||(n.isAsync=St(o)),n},{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}function Mn(e,t,n){var r;if(t.length>0){var o=Rn(t,n),i=N(N({},o),{constr:e});o.isAsync?r=xn(i):r=Ct(i)}else r=new e;return r}function Ct(e){var t,n=new((t=e.constr).bind.apply(t,On([void 0],e.constructorInjections,!1)));return e.propertyRequests.forEach(function(r,o){var i=r.target.identifier,s=e.propertyInjections[o];(!r.target.isOptional()||s!==void 0)&&(n[i]=s)}),n}function xn(e){return It(this,void 0,void 0,function(){var t,n;return Nt(this,function(r){switch(r.label){case 0:return[4,it(e.constructorInjections)];case 1:return t=r.sent(),[4,it(e.propertyInjections)];case 2:return n=r.sent(),[2,Ct(N(N({},e),{constructorInjections:t,propertyInjections:n}))]}})})}function it(e){return It(this,void 0,void 0,function(){var t,n,r,o;return Nt(this,function(i){for(t=[],n=0,r=e;n<r.length;n++)o=r[n],Array.isArray(o)?t.push(Promise.all(o)):t.push(o);return[2,Promise.all(t)]})})}function ot(e,t){var n=Bn(e,t);return y(n)?n.then(function(){return t}):t}function Bn(e,t){var n,r;if(Reflect.hasMetadata(X,e)){var o=Reflect.getMetadata(X,e);try{return(r=(n=t)[o.value])===null||r===void 0?void 0:r.call(n)}catch(i){if(i instanceof Error)throw new Error(tn(e.name,i.message))}}}function Pn(e,t){e.scope!==p.Singleton&&Fn(e,t)}function Fn(e,t){var n="Class cannot be instantiated in "+(e.scope===p.Request?"request":"transient")+" scope.";if(typeof e.onDeactivation=="function")throw new Error(J(t.name,n));if(Reflect.hasMetadata($,t))throw new Error(nn(t.name,n))}function jn(e,t,n,r){Pn(e,t);var o=Mn(t,n,r);return y(o)?o.then(function(i){return ot(t,i)}):ot(t,o)}var kn=globalThis&&globalThis.__awaiter||function(e,t,n,r){function o(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function u(c){try{a(r.next(c))}catch(f){s(f)}}function l(c){try{a(r.throw(c))}catch(f){s(f)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((r=r.apply(e,t||[])).next())})},Vn=globalThis&&globalThis.__generator||function(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return n.label++,{value:a[1],done:!1};case 5:n.label++,o=a[1],a=[0];continue;case 7:a=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){n.label=a[1];break}if(a[0]===6&&n.label<i[1]){n.label=i[1],i=a;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(a);break}i[2]&&n.ops.pop(),n.trys.pop();continue}a=t.call(e,n)}catch(c){a=[6,c],o=0}finally{r=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Q=function(e){return function(t){t.parentContext.setCurrentRequest(t);var n=t.bindings,r=t.childRequests,o=t.target&&t.target.isArray(),i=!t.parentRequest||!t.parentRequest.target||!t.target||!t.parentRequest.target.matchesArray(t.target.serviceIdentifier);if(o&&i)return r.map(function(u){var l=Q(e);return l(u)});if(t.target.isOptional()&&n.length===0)return;var s=n[0];return Un(e,t,s)}},Wn=function(e,t){var n=En(e);return an(function(){return n.factory.bind(e)(t)},function(){return new Error(en(n.factoryType,t.currentRequest.serviceIdentifier.toString()))})},Ln=function(e,t,n){var r,o=t.childRequests;switch(Dn(n),n.type){case d.ConstantValue:case d.Function:r=n.cache;break;case d.Constructor:r=n.implementationType;break;case d.Instance:r=jn(n,n.implementationType,o,Q(e));break;default:r=Wn(n,t.parentContext)}return r},Gn=function(e,t,n){var r=Tn(e,t);return r!==null||(r=n(),Sn(e,t,r)),r},Un=function(e,t,n){return Gn(e,n,function(){var r=Ln(e,t,n);return y(r)?r=r.then(function(o){return at(t,n,o)}):r=at(t,n,r),r})};function at(e,t,n){var r=Kn(e.parentContext,t,n),o=$n(e.parentContext.container),i,s=o.next();do{i=s.value;var u=e.parentContext,l=e.serviceIdentifier,a=Yn(i,l);y(r)?r=Dt(a,u,r):r=Hn(a,u,r),s=o.next()}while(s.done!==!0&&!V(i).hasKey(e.serviceIdentifier));return r}var Kn=function(e,t,n){var r;return typeof t.onActivation=="function"?r=t.onActivation(e,n):r=n,r},Hn=function(e,t,n){for(var r=e.next();!r.done;){if(n=r.value(t,n),y(n))return Dt(e,t,n);r=e.next()}return n},Dt=function(e,t,n){return kn(void 0,void 0,void 0,function(){var r,o;return Vn(this,function(i){switch(i.label){case 0:return[4,n];case 1:r=i.sent(),o=e.next(),i.label=2;case 2:return o.done?[3,4]:[4,o.value(t,r)];case 3:return r=i.sent(),o=e.next(),[3,2];case 4:return[2,r]}})})},Yn=function(e,t){var n=e._activations;return n.hasKey(t)?n.get(t).values():[].values()},$n=function(e){for(var t=[e],n=e.parent;n!==null;)t.push(n),n=n.parent;var r=function(){var i=t.pop();return i!==void 0?{done:!1,value:i}:{done:!0,value:void 0}},o={next:r};return o};function Jn(e){var t=Q(e.plan.rootRequest.requestScope);return t(e.plan.rootRequest)}var A=function(e,t){var n=e.parentRequest;return n!==null?t(n)?!0:A(n,t):!1},O=function(e){return function(t){var n=function(r){return r!==null&&r.target!==null&&r.target.matchesTag(e)(t)};return n.metaData=new I(e,t),n}},F=O(b),H=function(e){return function(t){var n=null;if(t!==null)if(n=t.bindings[0],typeof e=="string"){var r=n.serviceIdentifier;return r===e}else{var o=t.bindings[0].implementationType;return e===o}return!1}},W=function(){function e(t){this._binding=t}return e.prototype.when=function(t){return this._binding.constraint=t,new v(this._binding)},e.prototype.whenTargetNamed=function(t){return this._binding.constraint=F(t),new v(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(t){if(t===null)return!1;var n=t.target!==null&&!t.target.isNamed()&&!t.target.isTagged();return n},new v(this._binding)},e.prototype.whenTargetTagged=function(t,n){return this._binding.constraint=O(t)(n),new v(this._binding)},e.prototype.whenInjectedInto=function(t){return this._binding.constraint=function(n){return n!==null&&H(t)(n.parentRequest)},new v(this._binding)},e.prototype.whenParentNamed=function(t){return this._binding.constraint=function(n){return n!==null&&F(t)(n.parentRequest)},new v(this._binding)},e.prototype.whenParentTagged=function(t,n){return this._binding.constraint=function(r){return r!==null&&O(t)(n)(r.parentRequest)},new v(this._binding)},e.prototype.whenAnyAncestorIs=function(t){return this._binding.constraint=function(n){return n!==null&&A(n,H(t))},new v(this._binding)},e.prototype.whenNoAncestorIs=function(t){return this._binding.constraint=function(n){return n!==null&&!A(n,H(t))},new v(this._binding)},e.prototype.whenAnyAncestorNamed=function(t){return this._binding.constraint=function(n){return n!==null&&A(n,F(t))},new v(this._binding)},e.prototype.whenNoAncestorNamed=function(t){return this._binding.constraint=function(n){return n!==null&&!A(n,F(t))},new v(this._binding)},e.prototype.whenAnyAncestorTagged=function(t,n){return this._binding.constraint=function(r){return r!==null&&A(r,O(t)(n))},new v(this._binding)},e.prototype.whenNoAncestorTagged=function(t,n){return this._binding.constraint=function(r){return r!==null&&!A(r,O(t)(n))},new v(this._binding)},e.prototype.whenAnyAncestorMatches=function(t){return this._binding.constraint=function(n){return n!==null&&A(n,t)},new v(this._binding)},e.prototype.whenNoAncestorMatches=function(t){return this._binding.constraint=function(n){return n!==null&&!A(n,t)},new v(this._binding)},e}(),v=function(){function e(t){this._binding=t}return e.prototype.onActivation=function(t){return this._binding.onActivation=t,new W(this._binding)},e.prototype.onDeactivation=function(t){return this._binding.onDeactivation=t,new W(this._binding)},e}(),m=function(){function e(t){this._binding=t,this._bindingWhenSyntax=new W(this._binding),this._bindingOnSyntax=new v(this._binding)}return e.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},e.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(t,n){return this._bindingWhenSyntax.whenTargetTagged(t,n)},e.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},e.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},e.prototype.whenParentTagged=function(t,n){return this._bindingWhenSyntax.whenParentTagged(t,n)},e.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},e.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},e.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},e.prototype.whenAnyAncestorTagged=function(t,n){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,n)},e.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},e.prototype.whenNoAncestorTagged=function(t,n){return this._bindingWhenSyntax.whenNoAncestorTagged(t,n)},e.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},e.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},e.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},e.prototype.onDeactivation=function(t){return this._bindingOnSyntax.onDeactivation(t)},e}(),zn=function(){function e(t){this._binding=t}return e.prototype.inRequestScope=function(){return this._binding.scope=p.Request,new m(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=p.Singleton,new m(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=p.Transient,new m(this._binding)},e}(),st=function(){function e(t){this._binding=t,this._bindingWhenSyntax=new W(this._binding),this._bindingOnSyntax=new v(this._binding),this._bindingInSyntax=new zn(t)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},e.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(t,n){return this._bindingWhenSyntax.whenTargetTagged(t,n)},e.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},e.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},e.prototype.whenParentTagged=function(t,n){return this._bindingWhenSyntax.whenParentTagged(t,n)},e.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},e.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},e.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},e.prototype.whenAnyAncestorTagged=function(t,n){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,n)},e.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},e.prototype.whenNoAncestorTagged=function(t,n){return this._bindingWhenSyntax.whenNoAncestorTagged(t,n)},e.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},e.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},e.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},e.prototype.onDeactivation=function(t){return this._bindingOnSyntax.onDeactivation(t)},e}(),qn=function(){function e(t){this._binding=t}return e.prototype.to=function(t){return this._binding.type=d.Instance,this._binding.implementationType=t,new st(this._binding)},e.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+$t);var t=this._binding.serviceIdentifier;return this.to(t)},e.prototype.toConstantValue=function(t){return this._binding.type=d.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=p.Singleton,new m(this._binding)},e.prototype.toDynamicValue=function(t){return this._binding.type=d.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new st(this._binding)},e.prototype.toConstructor=function(t){return this._binding.type=d.Constructor,this._binding.implementationType=t,this._binding.scope=p.Singleton,new m(this._binding)},e.prototype.toFactory=function(t){return this._binding.type=d.Factory,this._binding.factory=t,this._binding.scope=p.Singleton,new m(this._binding)},e.prototype.toFunction=function(t){if(typeof t!="function")throw new Error(Ht);var n=this.toConstantValue(t);return this._binding.type=d.Function,this._binding.scope=p.Singleton,n},e.prototype.toAutoFactory=function(t){return this._binding.type=d.Factory,this._binding.factory=function(n){var r=function(){return n.container.get(t)};return r},this._binding.scope=p.Singleton,new m(this._binding)},e.prototype.toAutoNamedFactory=function(t){return this._binding.type=d.Factory,this._binding.factory=function(n){return function(r){return n.container.getNamed(t,r)}},new m(this._binding)},e.prototype.toProvider=function(t){return this._binding.type=d.Provider,this._binding.provider=t,this._binding.scope=p.Singleton,new m(this._binding)},e.prototype.toService=function(t){this.toDynamicValue(function(n){return n.container.get(t)})},e}(),Qn=function(){function e(){}return e.of=function(t,n,r,o,i){var s=new e;return s.bindings=t,s.middleware=n,s.deactivations=o,s.activations=r,s.moduleActivationStore=i,s},e}();function Zn(e){return typeof e=="object"&&e!==null&&"clone"in e&&typeof e.clone=="function"}var S=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(t,n){if(t==null)throw new Error(E);if(n==null)throw new Error(E);var r=this._map.get(t);r!==void 0?r.push(n):this._map.set(t,[n])},e.prototype.get=function(t){if(t==null)throw new Error(E);var n=this._map.get(t);if(n!==void 0)return n;throw new Error(nt)},e.prototype.remove=function(t){if(t==null)throw new Error(E);if(!this._map.delete(t))throw new Error(nt)},e.prototype.removeIntersection=function(t){var n=this;this.traverse(function(r,o){var i=t.hasKey(r)?t.get(r):void 0;if(i!==void 0){var s=o.filter(function(u){return!i.some(function(l){return u===l})});n._setValue(r,s)}})},e.prototype.removeByCondition=function(t){var n=this,r=[];return this._map.forEach(function(o,i){for(var s=[],u=0,l=o;u<l.length;u++){var a=l[u],c=t(a);c?r.push(a):s.push(a)}n._setValue(i,s)}),r},e.prototype.hasKey=function(t){if(t==null)throw new Error(E);return this._map.has(t)},e.prototype.clone=function(){var t=new e;return this._map.forEach(function(n,r){n.forEach(function(o){return t.add(r,Zn(o)?o.clone():o)})}),t},e.prototype.traverse=function(t){this._map.forEach(function(n,r){t(r,n)})},e.prototype._setValue=function(t,n){n.length>0?this._map.set(t,n):this._map.delete(t)},e}(),Xn=function(){function e(){this._map=new Map}return e.prototype.remove=function(t){if(this._map.has(t)){var n=this._map.get(t);return this._map.delete(t),n}return this._getEmptyHandlersStore()},e.prototype.addDeactivation=function(t,n,r){this._getModuleActivationHandlers(t).onDeactivations.add(n,r)},e.prototype.addActivation=function(t,n,r){this._getModuleActivationHandlers(t).onActivations.add(n,r)},e.prototype.clone=function(){var t=new e;return this._map.forEach(function(n,r){t._map.set(r,{onActivations:n.onActivations.clone(),onDeactivations:n.onDeactivations.clone()})}),t},e.prototype._getModuleActivationHandlers=function(t){var n=this._map.get(t);return n===void 0&&(n=this._getEmptyHandlersStore(),this._map.set(t,n)),n},e.prototype._getEmptyHandlersStore=function(){var t={onActivations:new S,onDeactivations:new S};return t},e}(),L=globalThis&&globalThis.__assign||function(){return L=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},L.apply(this,arguments)},g=globalThis&&globalThis.__awaiter||function(e,t,n,r){function o(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function u(c){try{a(r.next(c))}catch(f){s(f)}}function l(c){try{a(r.throw(c))}catch(f){s(f)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((r=r.apply(e,t||[])).next())})},_=globalThis&&globalThis.__generator||function(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return n.label++,{value:a[1],done:!1};case 5:n.label++,o=a[1],a=[0];continue;case 7:a=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){n.label=a[1];break}if(a[0]===6&&n.label<i[1]){n.label=i[1],i=a;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(a);break}i[2]&&n.ops.pop(),n.trys.pop();continue}a=t.call(e,n)}catch(c){a=[6,c],o=0}finally{r=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},te=globalThis&&globalThis.__spreadArray||function(e,t,n){if(n||arguments.length===2)for(var r=0,o=t.length,i;r<o;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},he=function(){function e(t){var n=t||{};if(typeof n!="object")throw new Error(""+zt);if(n.defaultScope===void 0)n.defaultScope=p.Transient;else if(n.defaultScope!==p.Singleton&&n.defaultScope!==p.Transient&&n.defaultScope!==p.Request)throw new Error(""+qt);if(n.autoBindInjectable===void 0)n.autoBindInjectable=!1;else if(typeof n.autoBindInjectable!="boolean")throw new Error(""+Qt);if(n.skipBaseClassChecks===void 0)n.skipBaseClassChecks=!1;else if(typeof n.skipBaseClassChecks!="boolean")throw new Error(""+Zt);this.options={autoBindInjectable:n.autoBindInjectable,defaultScope:n.defaultScope,skipBaseClassChecks:n.skipBaseClassChecks},this.id=C(),this._bindingDictionary=new S,this._snapshots=[],this._middleware=null,this._activations=new S,this._deactivations=new S,this.parent=null,this._metadataReader=new on,this._moduleActivationStore=new Xn}return e.merge=function(t,n){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=new e,s=te([t,n],r,!0).map(function(a){return V(a)}),u=V(i);function l(a,c){a.traverse(function(f,h){h.forEach(function(w){c.add(w.serviceIdentifier,w.clone())})})}return s.forEach(function(a){l(a,u)}),i},e.prototype.load=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=this._getContainerModuleHelpersFactory(),o=0,i=t;o<i.length;o++){var s=i[o],u=r(s.id);s.registry(u.bindFunction,u.unbindFunction,u.isboundFunction,u.rebindFunction,u.unbindAsyncFunction,u.onActivationFunction,u.onDeactivationFunction)}},e.prototype.loadAsync=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return g(this,void 0,void 0,function(){var r,o,i,s,u;return _(this,function(l){switch(l.label){case 0:r=this._getContainerModuleHelpersFactory(),o=0,i=t,l.label=1;case 1:return o<i.length?(s=i[o],u=r(s.id),[4,s.registry(u.bindFunction,u.unbindFunction,u.isboundFunction,u.rebindFunction,u.unbindAsyncFunction,u.onActivationFunction,u.onDeactivationFunction)]):[3,4];case 2:l.sent(),l.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},e.prototype.unload=function(){for(var t=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];n.forEach(function(o){var i=t._removeModuleBindings(o.id);t._deactivateSingletons(i),t._removeModuleHandlers(o.id)})},e.prototype.unloadAsync=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return g(this,void 0,void 0,function(){var r,o,i,s;return _(this,function(u){switch(u.label){case 0:r=0,o=t,u.label=1;case 1:return r<o.length?(i=o[r],s=this._removeModuleBindings(i.id),[4,this._deactivateSingletonsAsync(s)]):[3,4];case 2:u.sent(),this._removeModuleHandlers(i.id),u.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.bind=function(t){var n=this.options.defaultScope||p.Transient,r=new Bt(t,n);return this._bindingDictionary.add(t,r),new qn(r)},e.prototype.rebind=function(t){return this.unbind(t),this.bind(t)},e.prototype.rebindAsync=function(t){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,this.unbindAsync(t)];case 1:return n.sent(),[2,this.bind(t)]}})})},e.prototype.unbind=function(t){if(this._bindingDictionary.hasKey(t)){var n=this._bindingDictionary.get(t);this._deactivateSingletons(n)}this._removeServiceFromDictionary(t)},e.prototype.unbindAsync=function(t){return g(this,void 0,void 0,function(){var n;return _(this,function(r){switch(r.label){case 0:return this._bindingDictionary.hasKey(t)?(n=this._bindingDictionary.get(t),[4,this._deactivateSingletonsAsync(n)]):[3,2];case 1:r.sent(),r.label=2;case 2:return this._removeServiceFromDictionary(t),[2]}})})},e.prototype.unbindAll=function(){var t=this;this._bindingDictionary.traverse(function(n,r){t._deactivateSingletons(r)}),this._bindingDictionary=new S},e.prototype.unbindAllAsync=function(){return g(this,void 0,void 0,function(){var t,n=this;return _(this,function(r){switch(r.label){case 0:return t=[],this._bindingDictionary.traverse(function(o,i){t.push(n._deactivateSingletonsAsync(i))}),[4,Promise.all(t)];case 1:return r.sent(),this._bindingDictionary=new S,[2]}})})},e.prototype.onActivation=function(t,n){this._activations.add(t,n)},e.prototype.onDeactivation=function(t,n){this._deactivations.add(t,n)},e.prototype.isBound=function(t){var n=this._bindingDictionary.hasKey(t);return!n&&this.parent&&(n=this.parent.isBound(t)),n},e.prototype.isCurrentBound=function(t){return this._bindingDictionary.hasKey(t)},e.prototype.isBoundNamed=function(t,n){return this.isBoundTagged(t,b,n)},e.prototype.isBoundTagged=function(t,n,r){var o=!1;if(this._bindingDictionary.hasKey(t)){var i=this._bindingDictionary.get(t),s=wn(this,t,n,r);o=i.some(function(u){return u.constraint(s)})}return!o&&this.parent&&(o=this.parent.isBoundTagged(t,n,r)),o},e.prototype.snapshot=function(){this._snapshots.push(Qn.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},e.prototype.restore=function(){var t=this._snapshots.pop();if(t===void 0)throw new Error(Ut);this._bindingDictionary=t.bindings,this._activations=t.activations,this._deactivations=t.deactivations,this._middleware=t.middleware,this._moduleActivationStore=t.moduleActivationStore},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this._middleware?this._middleware:this._planAndResolve();this._middleware=t.reduce(function(o,i){return i(o)},r)},e.prototype.applyCustomMetadataReader=function(t){this._metadataReader=t},e.prototype.get=function(t){var n=this._getNotAllArgs(t,!1);return this._getButThrowIfAsync(n)},e.prototype.getAsync=function(t){return g(this,void 0,void 0,function(){var n;return _(this,function(r){return n=this._getNotAllArgs(t,!1),[2,this._get(n)]})})},e.prototype.getTagged=function(t,n,r){var o=this._getNotAllArgs(t,!1,n,r);return this._getButThrowIfAsync(o)},e.prototype.getTaggedAsync=function(t,n,r){return g(this,void 0,void 0,function(){var o;return _(this,function(i){return o=this._getNotAllArgs(t,!1,n,r),[2,this._get(o)]})})},e.prototype.getNamed=function(t,n){return this.getTagged(t,b,n)},e.prototype.getNamedAsync=function(t,n){return this.getTaggedAsync(t,b,n)},e.prototype.getAll=function(t){var n=this._getAllArgs(t);return this._getButThrowIfAsync(n)},e.prototype.getAllAsync=function(t){var n=this._getAllArgs(t);return this._getAll(n)},e.prototype.getAllTagged=function(t,n,r){var o=this._getNotAllArgs(t,!0,n,r);return this._getButThrowIfAsync(o)},e.prototype.getAllTaggedAsync=function(t,n,r){var o=this._getNotAllArgs(t,!0,n,r);return this._getAll(o)},e.prototype.getAllNamed=function(t,n){return this.getAllTagged(t,b,n)},e.prototype.getAllNamedAsync=function(t,n){return this.getAllTaggedAsync(t,b,n)},e.prototype.resolve=function(t){var n=this.isBound(t);n||this.bind(t).toSelf();var r=this.get(t);return n||this.unbind(t),r},e.prototype._preDestroy=function(t,n){var r,o;if(Reflect.hasMetadata($,t)){var i=Reflect.getMetadata($,t);return(o=(r=n)[i.value])===null||o===void 0?void 0:o.call(r)}},e.prototype._removeModuleHandlers=function(t){var n=this._moduleActivationStore.remove(t);this._activations.removeIntersection(n.onActivations),this._deactivations.removeIntersection(n.onDeactivations)},e.prototype._removeModuleBindings=function(t){return this._bindingDictionary.removeByCondition(function(n){return n.moduleId===t})},e.prototype._deactivate=function(t,n){var r=this,o=Object.getPrototypeOf(n).constructor;try{if(this._deactivations.hasKey(t.serviceIdentifier)){var i=this._deactivateContainer(n,this._deactivations.get(t.serviceIdentifier).values());if(y(i))return this._handleDeactivationError(i.then(function(){return r._propagateContainerDeactivationThenBindingAndPreDestroyAsync(t,n,o)}),o)}var s=this._propagateContainerDeactivationThenBindingAndPreDestroy(t,n,o);if(y(s))return this._handleDeactivationError(s,o)}catch(u){if(u instanceof Error)throw new Error(J(o.name,u.message))}},e.prototype._handleDeactivationError=function(t,n){return g(this,void 0,void 0,function(){var r;return _(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,t];case 1:return o.sent(),[3,3];case 2:if(r=o.sent(),r instanceof Error)throw new Error(J(n.name,r.message));return[3,3];case 3:return[2]}})})},e.prototype._deactivateContainer=function(t,n){for(var r=this,o=n.next();o.value;){var i=o.value(t);if(y(i))return i.then(function(){return r._deactivateContainerAsync(t,n)});o=n.next()}},e.prototype._deactivateContainerAsync=function(t,n){return g(this,void 0,void 0,function(){var r;return _(this,function(o){switch(o.label){case 0:r=n.next(),o.label=1;case 1:return r.value?[4,r.value(t)]:[3,3];case 2:return o.sent(),r=n.next(),[3,1];case 3:return[2]}})})},e.prototype._getContainerModuleHelpersFactory=function(){var t=this,n=function(c,f){c._binding.moduleId=f},r=function(c){return function(f){var h=t.bind(f);return n(h,c),h}},o=function(){return function(c){return t.unbind(c)}},i=function(){return function(c){return t.unbindAsync(c)}},s=function(){return function(c){return t.isBound(c)}},u=function(c){return function(f){var h=t.rebind(f);return n(h,c),h}},l=function(c){return function(f,h){t._moduleActivationStore.addActivation(c,f,h),t.onActivation(f,h)}},a=function(c){return function(f,h){t._moduleActivationStore.addDeactivation(c,f,h),t.onDeactivation(f,h)}};return function(c){return{bindFunction:r(c),isboundFunction:s(),onActivationFunction:l(c),onDeactivationFunction:a(c),rebindFunction:u(c),unbindFunction:o(),unbindAsyncFunction:i()}}},e.prototype._getAll=function(t){return Promise.all(this._get(t))},e.prototype._get=function(t){var n=L(L({},t),{contextInterceptor:function(o){return o},targetType:P.Variable});if(this._middleware){var r=this._middleware(n);if(r==null)throw new Error(Kt);return r}return this._planAndResolve()(n)},e.prototype._getButThrowIfAsync=function(t){var n=this._get(t);if(St(n))throw new Error(Yt(t.serviceIdentifier));return n},e.prototype._getAllArgs=function(t){var n={avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:t};return n},e.prototype._getNotAllArgs=function(t,n,r,o){var i={avoidConstraints:!1,isMultiInject:n,serviceIdentifier:t,key:r,value:o};return i},e.prototype._planAndResolve=function(){var t=this;return function(n){var r=bn(t._metadataReader,t,n.isMultiInject,n.targetType,n.serviceIdentifier,n.key,n.value,n.avoidConstraints);r=n.contextInterceptor(r);var o=Jn(r);return o}},e.prototype._deactivateIfSingleton=function(t){var n=this;if(t.activated)return y(t.cache)?t.cache.then(function(r){return n._deactivate(t,r)}):this._deactivate(t,t.cache)},e.prototype._deactivateSingletons=function(t){for(var n=0,r=t;n<r.length;n++){var o=r[n],i=this._deactivateIfSingleton(o);if(y(i))throw new Error(Xt)}},e.prototype._deactivateSingletonsAsync=function(t){return g(this,void 0,void 0,function(){var n=this;return _(this,function(r){switch(r.label){case 0:return[4,Promise.all(t.map(function(o){return n._deactivateIfSingleton(o)}))];case 1:return r.sent(),[2]}})})},e.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(t,n,r){return this.parent?this._deactivate.bind(this.parent)(t,n):this._bindingDeactivationAndPreDestroy(t,n,r)},e.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(t,n,r){return g(this,void 0,void 0,function(){return _(this,function(o){switch(o.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(t,n)]:[3,2];case 1:return o.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(t,n,r)];case 3:o.sent(),o.label=4;case 4:return[2]}})})},e.prototype._removeServiceFromDictionary=function(t){try{this._bindingDictionary.remove(t)}catch{throw new Error(jt+" "+x(t))}},e.prototype._bindingDeactivationAndPreDestroy=function(t,n,r){var o=this;if(typeof t.onDeactivation=="function"){var i=t.onDeactivation(n);if(y(i))return i.then(function(){return o._preDestroy(r,n)})}return this._preDestroy(r,n)},e.prototype._bindingDeactivationAndPreDestroyAsync=function(t,n,r){return g(this,void 0,void 0,function(){return _(this,function(o){switch(o.label){case 0:return typeof t.onDeactivation!="function"?[3,2]:[4,t.onDeactivation(n)];case 1:o.sent(),o.label=2;case 2:return[4,this._preDestroy(r,n)];case 3:return o.sent(),[2]}})})},e}(),ne=function(){function e(t){this.id=C(),this.registry=t}return e}();function ee(e){for(var t=new Set,n=0,r=e;n<r.length;n++){var o=r[n];if(t.has(o))return o;t.add(o)}}function re(e){return e.prototype!==void 0}function ie(e){if(e!==void 0)throw new Error(pt)}function oe(e,t,n,r){ie(t),Et(lt,e,n.toString(),r)}function ae(e,t,n){if(re(e))throw new Error(pt);Et(ft,e.constructor,t,n)}function se(e){var t=[];if(Array.isArray(e)){t=e;var n=ee(t.map(function(r){return r.key}));if(n!==void 0)throw new Error(ht+" "+n.toString())}else t=[e];return t}function Et(e,t,n,r){var o=se(r),i={};Reflect.hasOwnMetadata(e,t)&&(i=Reflect.getMetadata(e,t));var s=i[n];if(s===void 0)s=[];else for(var u=function(f){if(o.some(function(h){return h.key===f.key}))throw new Error(ht+" "+f.key.toString())},l=0,a=s;l<a.length;l++){var c=a[l];u(c)}s.push.apply(s,o),i[n]=s,Reflect.defineMetadata(e,i,t)}function ue(e){return function(t,n,r){typeof r=="number"?oe(t,n,r,e):ae(t,n,e)}}function de(){return function(e){if(Reflect.hasOwnMetadata(Y,e))throw new Error(Pt);var t=Reflect.getMetadata(Rt,e)||[];return Reflect.defineMetadata(Y,t,e),e}}function ce(e){return function(t){return function(n,r,o){if(t===void 0){var i=typeof n=="function"?n.name:n.constructor.name;throw new Error(Wt(i))}return ue(new I(e,t))(n,r,o)}}}var pe=ce(G),le={provide:"inversify-binding-decorators:provide"};function ve(){return new ne(function(e,t){var n=Reflect.getMetadata(le.provide,Reflect)||[];n.map(function(r){return fe(r,e)})})}function fe(e,t){return e.constraint(t,e.implementationType)}export{he as C,pe as a,ve as b,de as i};
